#include <stdio.h>
#include <stdlib.h>
#include <time.h>

#define SIZE 5
#define NAVIOS 2

void inicializarTabuleiro(char tabuleiro[SIZE][SIZE]) {
    for(int i = 0; i < SIZE; i++)
        for(int j = 0; j < SIZE; j++)
            tabuleiro[i][j] = '~'; // Ã¡gua
}

void imprimirTabuleiro(char tabuleiro[SIZE][SIZE], int revelar) {
    printf("  ");
    for(int i = 0; i < SIZE; i++)
        printf("%d ", i);
    printf("\n");
    
    for(int i = 0; i < SIZE; i++) {
        printf("%d ", i);
        for(int j = 0; j < SIZE; j++) {
            if(revelar)
                printf("%c ", tabuleiro[i][j]);
            else
                printf("%c ", (tabuleiro[i][j] == 'N' ? '~' : tabuleiro[i][j]));
        }
        printf("\n");
    }
}

void posicionarNavios(char tabuleiro[SIZE][SIZE]) {
    int x, y, colocados = 0;
    srand(time(NULL));
    while(colocados < NAVIOS) {
        x = rand() % SIZE;
        y = rand() % SIZE;
        if(tabuleiro[x][y] != 'N') {
            tabuleiro[x][y] = 'N'; // navio
            colocados++;
        }
    }
}

int atacar(char tabuleiro[SIZE][SIZE], int x, int y) {
    if(tabuleiro[x][y] == 'N') {
        tabuleiro[x][y] = 'X'; // acerto
        return 1;
    } else if(tabuleiro[x][y] == '~') {
        tabuleiro[x][y] = 'O'; // erro
    }
    return 0;
}

int main() {
    char tabuleiro[SIZE][SIZE];
    int acertos = 0, x, y;

    inicializarTabuleiro(tabuleiro);
    posicionarNavios(tabuleiro);

    printf("=== BATALHA NAVAL ===\n");
    
    while(acertos < NAVIOS) {
        imprimirTabuleiro(tabuleiro, 0);
        printf("Digite linha e coluna para atacar: ");
        scanf("%d %d", &x, &y);

        if(x < 0 || x >= SIZE || y < 0 || y >= SIZE) {
            printf("Coordenadas invalidas!\n");
            continue;
        }

        if(atacar(tabuleiro, x, y)) {
            printf("Acertou!\n");
            acertos++;
        } else {
            printf("Errou!\n");
        }
    }

    printf("Parabens! Voce afundou todos os navios!\n");
    imprimirTabuleiro(tabuleiro, 1); // revela todos
    return 0;
}
